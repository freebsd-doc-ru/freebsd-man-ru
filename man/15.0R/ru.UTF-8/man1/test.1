.\"-
.\" Copyright (c) 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" the Institute of Electrical and Electronics Engineers, Inc.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @(#)test.1	8.1 (Berkeley) 5/31/93
.\"
.\" FRDP path ./bin/test/test.1
.\" FRDP githash 90aea514c6249118e880d75972d063362f4bf492
.\" FRDP hash256 73baff28cf19d59db7ddbf58e8461b2b09372da0ff75a07ee3f2d1cb6a5a4e0f
.Dd 5 октября 2016
.Dt TEST 1
.Os
.Sh ИМЯ
.Nm test ,
.Nm \&[
.Nd утилита проверки условий
.Sh СИНТАКСИС
.Nm
.Ar выражение
.Nm \&[
.Ar выражение Cm \&]
.Sh ОПИСАНИЕ
Утилита
.Nm
оценивает выражение и, если оно истинно,
возвращает нулевой статус выхода (истина); в противном случае
возвращает 1 (ложь).
Если выражение отсутствует,
.Nm
также возвращает 1 (ложь).
.Pp
Все операторы и флаги являются отдельными аргументами для
утилиты
.Nm .
.Pp
Для построения выражения используются следующие примитивы:
.Bl -tag -width Ar
.It Fl b Ar файл
Истина, если
.Ar файл
существует и является блочным специальным
файлом.
.It Fl c Ar файл
Истина, если
.Ar файл
существует и является символьным
специальным файлом.
.It Fl d Ar файл
Истина, если
.Ar файл
существует и является каталогом.
.It Fl e Ar файл
Истина, если
.Ar файл
существует (независимо от типа).
.It Fl f Ar файл
Истина, если
.Ar файл
существует и является обычным файлом.
.It Fl g Ar файл
Истина, если
.Ar файл
существует и у него установлен флаг
установки идентификатора группы.
.It Fl h Ar файл
Истина, если
.Ar файл
существует и является символической ссылкой.
Этот оператор оставлен для совместимости с предыдущими версиями
этой программы.
Не полагайтесь на его наличие; используйте вместо него
.Fl L .
.It Fl k Ar файл
Истина, если
.Ar файл
существует и у него установлен sticky-бит.
.It Fl n Ar строка
Истина, если длина
.Ar строки
не равна нулю.
.It Fl p Ar файл
Истина, если
.Ar файл
является именованным каналом
.Pq Tn FIFO .
.It Fl r Ar файл
Истина, если
.Ar файл
существует и доступен для чтения.
.It Fl s Ar файл
Истина, если
.Ar файл
существует и имеет размер больше
нуля.
.It Fl t Ar файловый_дескриптор
Истина, если файл, чей номер файлового дескриптора
равен
.Ar файловый_дескриптор ,
открыт и связан с терминалом.
.It Fl u Ar файл
Истина, если
.Ar файл
существует и у него установлен флаг
установки идентификатора пользователя.
.It Fl w Ar файл
Истина, если
.Ar файл
существует и доступен для записи.
Истина
указывает только на то, что установлен флаг записи.
Файл недоступен для записи в файловой системе только для чтения,
даже если этот тест показывает истину.
.It Fl x Ar файл
Истина, если
.Ar файл
существует и является исполняемым.
Истина
указывает только на то, что установлен флаг выполнения.
Если
.Ar файл
является каталогом, истина указывает, что в
.Ar файле
можно выполнять поиск.
.It Fl z Ar строка
Истина, если длина
.Ar строки
равна нулю.
.It Fl L Ar файл
Истина, если
.Ar файл
существует и является символической ссылкой.
.It Fl O Ar файл
Истина, если
.Ar файл
существует и его владелец совпадает с эффективным идентификатором пользователя этого процесса.
.It Fl G Ar файл
Истина, если
.Ar файл
существует и его группа совпадает с эффективным идентификатором группы этого процесса.
.It Fl S Ar файл
Истина, если
.Ar файл
существует и является сокетом.
.It Ar файл1 Fl nt Ar файл2
Истина, если
.Ar файл1
существует и новее, чем
.Ar файл2 .
.It Ar файл1 Fl ot Ar файл2
Истина, если
.Ar файл1
существует и старше, чем
.Ar файл2 .
.It Ar файл1 Fl ef Ar файл2
Истина, если
.Ar файл1
и
.Ar файл2
существуют и ссылаются на один и тот же файл.
.It Ar строка
Истина, если
.Ar строка
не является пустой
строкой.
.It Ar s1 Cm = Ar s2
Истина, если строки
.Ar s1
и
.Ar s2
идентичны.
.It Ar s1 Cm != Ar s2
Истина, если строки
.Ar s1
и
.Ar s2
не идентичны.
.It Ar s1 Cm < Ar s2
Истина, если строка
.Ar s1
предшествует строке
.Ar s2
на основе двоичного значения их символов.
.It Ar s1 Cm > Ar s2
Истина, если строка
.Ar s1
следует после строки
.Ar s2
на основе двоичного значения их символов.
.It Ar n1 Fl eq Ar n2
Истина, если целые числа
.Ar n1
и
.Ar n2
алгебраически
равны.
.It Ar n1 Fl ne Ar n2
Истина, если целые числа
.Ar n1
и
.Ar n2
не
алгебраически равны.
.It Ar n1 Fl gt Ar n2
Истина, если целое число
.Ar n1
алгебраически
больше целого числа
.Ar n2 .
.It Ar n1 Fl ge Ar n2
Истина, если целое число
.Ar n1
алгебраически
больше или равно целому числу
.Ar n2 .
.It Ar n1 Fl lt Ar n2
Истина, если целое число
.Ar n1
алгебраически меньше
целого числа
.Ar n2 .
.It Ar n1 Fl le Ar n2
Истина, если целое число
.Ar n1
алгебраически меньше
или равно целому числу
.Ar n2 .
.El
.Pp
Если
.Ar файл
является символической ссылкой,
.Nm
полностью разыменует её и затем оценит выражение
относительно файла, на который она указывает, за исключением
примитивов
.Fl h
и
.Fl L .
.Pp
Эти примитивы можно комбинировать со следующими операторами:
.Bl -tag -width Ar
.It Cm \&! Ar выражение
Истина, если
.Ar выражение
ложно.
.It Ar выражение1 Fl a Ar выражение2
Истина, если оба
.Ar выражение1
и
.Ar выражение2
истинны.
.It Ar выражение1 Fl o Ar выражение2
Истина, если хотя бы одно из
.Ar выражение1
или
.Ar выражение2
истинно.
.It Cm \&( Ar выражение Cm \&)
Истина, если выражение истинно.
.El
.Pp
Оператор
.Fl a
имеет более высокий приоритет, чем оператор
.Fl o .
.Pp
Некоторые оболочки могут предоставлять встроенную команду
.Nm ,
которая похожа или идентична этой утилите.
Обратитесь к справочной странице
.Xr builtin 1 .
.Sh НЕОДНОЗНАЧНОСТЬ ГРАММАТИКИ
Грамматика
.Nm
по своей природе неоднозначна.
Чтобы обеспечить определённую степень согласованности,
случаи, описанные в стандарте
.St -p1003.2 ,
раздел D11.2/4.62.4,
оцениваются последовательно в соответствии с правилами, указанными в
стандартном документе.
Все остальные случаи подвержены неоднозначности в
семантике команд.
.Pp
В частности, только выражения, содержащие
.Fl a ,
.Fl o ,
.Cm \&(
или
.Cm \&) ,
могут быть неоднозначными.
.Sh СТАТУС ВЫХОДА
Утилита
.Nm
завершает работу со следующими значениями:
.Bl -tag -width indent
.It 0
выражение оценивается как истинное.
.It 1
выражение оценивается как ложное или выражение
отсутствует.
.It >1
Произошла ошибка.
.El
.Sh ПРИМЕРЫ
Реализация
.Li test ФАЙЛ1 -nt ФАЙЛ2
с использованием только возможностей
.Tn POSIX :
.Pp
.Pp
Это можно изменить, используя нестандартные
примитивы
.Xr find 1 ,
такие как
.Cm -newerca ,
для сравнения других временных меток.
.Sh СОВМЕСТИМОСТЬ
Для совместимости с некоторыми другими реализациями,
примитив
.Cm =
может быть заменён на
.Cm ==
с тем же значением.
.Sh СМ. ТАКЖЕ
.Xr builtin 1 ,
.Xr expr 1 ,
.Xr find 1 ,
.Xr sh 1 ,
.Xr stat 1 ,
.Xr symlink 7
.Sh СТАНДАРТЫ
Утилита
.Nm
реализует надмножество спецификации
.St -p1003.2 .
Примитивы
.Cm < ,
.Cm == ,
.Cm > ,
.Fl ef ,
.Fl nt ,
.Fl ot ,
.Fl G ,
и
.Fl O
являются расширениями.
.Sh ИСТОРИЯ
Утилита
.Nm
появилась в
.At v7 .
.Sh ИЗВЕСТНЫЕ ОШИБКИ
Обе стороны всегда вычисляются в операторах
.Fl a
и
.Fl o .
Например, статус доступности на запись
.Pa файла
будет проверен следующей командой, даже если первое выражение
указывало на ложь, что приводит к излишнему обращению к файловой системе:
Чтобы избежать этого, напишите
