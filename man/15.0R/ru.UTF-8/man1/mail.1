.\" Copyright (c) 1980, 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@(#)mail.1	8.8 (Berkeley) 4/28/95
.\"
.\" FRDP path ./usr.bin/mail/mail.1
.\" FRDP githash bdcbfde31e8e9b343f113a1956384bdf30d1ed62
.\" FRDP hash256 2345e4d36a0a0837c1f4732fc595b77eaa796169b359c25f56a4499be6fa7d02
.Dd 8 августа 2018
.Dt MAIL 1
.Os
.Sh ИМЯ
.Nm mail ,
.Nm Mail ,
.Nm mailx
.Nd отправка и получение почты
.Sh СИНТАКСИС
.Nm
.Op Fl dEiInv
.Op Fl s Ar тема
.Op Fl c Ar копия-адрес
.Op Fl b Ar скрытая-копия-адрес
.Op Fl F
.Ar адрес-получателя ...
.Op Fl Ar опция-sendmail ...
.Nm
.Op Fl dEHiInNv
.Op Fl F
.Fl f
.Op Ar имя
.Nm
.Op Fl dEHiInNv
.Op Fl F
.Op Fl u Ar пользователь
.Nm
.Op Fl d
.Fl e
.Op Fl f Ar имя
.Sh ВВЕДЕНИЕ
Утилита
.Nm
представляет собой интеллектуальную систему обработки почты,
чьи команды напоминают синтаксис
.Xr ed 1 ,
где строки заменены сообщениями.
.Pp
Доступны следующие опции:
.Bl -tag -width indent
.It Fl v
Подробный режим.
Детали доставки отображаются на терминале пользователя.
.It Fl d
Режим отладки.
Подробности см. в описании опции почты
.Va debug .
.It Fl e
Проверить наличие почты в (по умолчанию, системном)
почтовом ящике.
Возвращает статус выхода 0, если
почта есть; иначе возвращает статус выхода
1.
.It Fl H
Вывести только сводку заголовков, затем завершиться.
.It Fl E
Не отправлять сообщения с пустым телом.
Полезно для передачи ошибок из
скриптов
.Xr cron 8 .
.It Fl i
Игнорировать сигналы прерывания с tty.
Особенно полезно при использовании
.Nm
на зашумленных телефонных линиях.
.It Fl I
Принудительно запускать
.Nm
в интерактивном режиме, даже если
ввод не с терминала.
В частности, специальный символ
.Ql ~
при отправке почты активен только в интерактивном режиме.
.It Fl n
Запретить чтение общесистемных файлов
.Pa mail.rc
при запуске.
.It Fl N
Запретить первоначальный вывод заголовков сообщений
при чтении почты или редактировании папки.
.It Fl s Ar тема
Указать
.Ar тему
в командной строке.
(Только первый аргумент после флага
.Fl s
используется как тема; будьте осторожны с темами,
содержащими пробелы, заключайте их в кавычки.)
.It Fl c Ar копия-адрес
Отправить копии списку пользователей
.Ar копия-адрес .
Аргумент
.Ar копия-адрес
должен быть списком имён, разделённых запятыми.
.It Fl b Ar скрытая-копия-адрес
Отправить скрытые копии списку пользователей
.Ar скрытая-копия-адрес .
Аргумент
.Ar скрытая-копия-адрес
должен быть списком имён, разделённых запятыми.
.It Fl f Op Ar почтовый_ящик
Прочитать содержимое вашего
.Pa почтового_ящика
(или указанного файла)
для обработки; при выполнении команды
.Ic quit ,
.Nm
записывает неудалённые сообщения обратно в этот файл.
.It Fl F
Записать сообщение в файл, названный в честь первого
получателя.
Имя — это часть логина из
адреса, найденного первым в строке
.Dq Li To:
в заголовке письма.
Переопределяет переменную
.Va record ,
если она установлена.
.It Fl u Ar пользователь
Эквивалентно:
.Pp
.El
При запуске
.Nm
выполняет команды из системных командных файлов
.Pa /usr/share/misc/mail.rc ,
.Pa /usr/local/etc/mail.rc
и
.Pa /etc/mail.rc
по порядку, если явно не указано обратное с помощью опции
.Fl n .
Затем выполняются команды из личного командного файла пользователя
.Pa ~/.mailrc .
Утилита
.Nm
затем анализирует свои параметры командной строки, чтобы определить, нужно ли
отправлять новое сообщение или следует читать существующий почтовый ящик.
Для отправки сообщения одному или нескольким людям,
.Nm
может быть вызвана с аргументами — именами людей, которым
будет отправлена почта.
Затем ожидается, что вы введёте
своё сообщение, завершив его
.Aq Li control-D
в начале строки.
Раздел ниже
описывает некоторые возможности
.Nm ,
доступные для помощи в составлении письма.
При обычном использовании
.Nm
вызывается без аргументов, проверяет вашу почту в
почтовом отделении, затем
выводит однострочный заголовок каждого найденного сообщения.
Текущим сообщением изначально является первое сообщение (номер 1),
и его можно вывести с помощью команды
.Ic print
(которую можно сократить до
.Ic p ) .
Вы можете перемещаться между сообщениями так же, как между строками в
.Xr ed 1 ,
с помощью команд
.Ic +
и
.Ic \- ,
перемещающих назад и вперёд, а также
простых номеров.
После просмотра сообщения вы можете
удалить
.Pq Ic d
сообщение или
ответить
.Pq Ic r
на него.
Удаление приводит к тому, что программа
.Nm
«забывает» о сообщении.
Это обратимо; сообщение можно
восстановить
.Pq Ic u ,
указав его номер, или
сеанс
.Nm
можно прервать командой
.Ic exit
.Pq Ic x .
Однако удалённые сообщения обычно исчезают навсегда.
Командам, таким как
.Ic print
и
.Ic delete ,
можно передавать список номеров сообщений в качестве аргументов, чтобы
применить их к нескольким сообщениям сразу.
Например,
удаляет сообщения 1 и 2, а
удаляет сообщения с 1 по 5.
Специальное имя
.Ql *
обозначает все сообщения, а
.Ql $
—
последнее сообщение; таким образом, команда
.Ic top ,
которая выводит первые несколько строк сообщения, может быть использована в
для вывода первых строк всех сообщений.
Вы можете использовать команду
.Ic reply
чтобы
создать ответ на сообщение, отправив его обратно
отправителю.
Введённый вами текст до конца файла
определяет содержимое сообщения.
Во время составления сообщения
.Nm
особенно обрабатывает строки, начинающиеся с символа
.Ql ~ .
Например, ввод
.Ic ~m
(одного на строке) поместит копию
текущего сообщения в ответ, сдвинув его на табуляцию
(см. переменную
.Va indentprefix
ниже).
Другие escape-последовательности устанавливают поле темы, добавляют и удаляют получателей
сообщения и позволяют перейти в редактор для исправления
сообщения или в оболочку для выполнения команд.
(Эти возможности
приведены в сводке ниже.)
Вы можете завершить сеанс
.Nm
командой
.Ic quit
.Pq Ic q .
Просмотренные сообщения попадают в ваш файл
.Pa mbox ,
если они не были удалены, в таком случае они отбрасываются.
Непросмотренные сообщения возвращаются в почтовое отделение.
(См. опцию
.Fl f
выше).
Также можно создать персональные списки рассылки, чтобы,
например, отправлять почту на
.Dq Li cohorts ,
и она будет доставлена
группе людей.
Такие списки можно определить, поместив строку вида
.Pp
.Pp
в файл
.Pa .mailrc
в вашем домашнем каталоге.
Текущий список таких псевдонимов можно вывести с помощью команды
.Ic alias
в
.Nm .
Общесистемные списки рассылки можно создать, отредактировав
.Pa /etc/mail/aliases ,
см.
.Xr aliases 5
и
.Xr sendmail 8 ;
они используют другой синтаксис.
В отправляемой вами почте персональные псевдонимы будут раскрыты для получателей,
чтобы они могли
.Ic reply
на них.
Общесистемные
псевдонимы
не раскрываются при отправке письма,
но любой ответ, возвращённый на машину, будет иметь раскрытый общесистемный
псевдоним, поскольку вся почта проходит через
.Xr sendmail 8 .
.Pp
Утилита
.Nm
имеет ряд опций, которые можно установить в файле
.Pa .mailrc
для изменения её поведения; например,
включает функцию
.Va askcc .
(Эти опции суммированы ниже.)
.Sh ОБЗОР
(Адаптировано из
.Pp
Каждая команда вводится на отдельной строке и может принимать аргументы
после слова команды.
Команду не обязательно вводить полностью — используется первая команда,
совпадающая с введённым префиксом.
Для команд, принимающих списки сообщений в качестве аргументов, если список сообщений не указан,
используется следующее подходящее сообщение вперёд по потоку.
Если нет сообщений вперёд от
текущего сообщения, поиск выполняется назад, и если вообще нет
подходящих сообщений,
.Nm
выводит
и
прерывает команду.
.Bl -tag -width indent
.It Ic \-
Вывести предыдущее сообщение.
Если задан числовой
аргумент
.Ar n ,
переходит к
.Ar n Ns -ому
предыдущему сообщению и выводит его.
.It Ic #
Игнорировать оставшуюся часть строки как комментарий.
.It Ic \&?
Выводит краткую сводку команд.
.It Ic \&!
Выполняет следующую за ней команду оболочки
(см.
.Xr sh 1
и
.Xr csh 1 ).
.It Ic Print
.Pq Ic P
Как
.Ic print ,
но также выводит игнорируемые поля заголовка.
См. также
.Ic print , ignore
и
.Ic retain .
.It Ic Reply
.Pq Ic R
Ответить отправителю.
Не отвечает другим
получателям исходного сообщения.
.It Ic Type
.Pq Ic T
Идентично команде
.Ic Print .
.It Ic alias
.Pq Ic a
Без аргументов выводит все определённые в данный момент псевдонимы.
С одним
аргументом выводит этот псевдоним.
С более чем одним аргументом создаёт
новый псевдоним или изменяет существующий.
.It Ic alternates
.Pq Ic alt
Команда
.Ic alternates
полезна, если у вас есть учётные записи на нескольких машинах.
Она может использоваться, чтобы сообщить
.Nm ,
что перечисленные адреса действительно принадлежат вам.
Когда вы
.Ic reply
на сообщения,
.Nm
не будет отправлять копию сообщения ни на один из адресов,
указанных в списке
.Ic alternates .
Если команда
.Ic alternates
вызвана без аргументов, отображается текущий набор альтернативных
имён.
.It Ic chdir
.Pq Ic c
Изменяет рабочий каталог пользователя на указанный, если задан.
Если
каталог не указан, переходит в домашний каталог пользователя.
.It Ic copy
.Pq Ic co
Команда
.Ic copy
делает то же самое, что и
.Ic save ,
за исключением того, что она не помечает сообщения, которые
использует, для удаления при выполнении команды
.Ic quit .
.It Ic delete
.Pq Ic d
Принимает список сообщений в качестве аргумента и помечает их все как удалённые.
Удалённые сообщения не будут сохранены в
.Pa mbox ,
и не будут доступны для большинства других команд.
.It Ic dp
(также
.Ic dt )
Удаляет текущее сообщение и выводит следующее.
Если следующего сообщения нет,
.Nm
сообщает
.It Ic edit
.Pq Ic e
Принимает список сообщений и направляет текстовый редактор на каждое из них по очереди.
После возврата из редактора сообщение считывается обратно.
.It Ic exit
.Ic ( ex
или
.Ic x )
Немедленно возвращает в оболочку без
изменения системного почтового ящика пользователя, его файла
.Pa mbox
или редактируемого файла в
.Fl f .
.It Ic file
.Pq Ic fi
То же, что и
.Ic folder .
.It Ic folders
Выводит имена папок в вашем каталоге папок.
.It Ic folder
.Pq Ic fo
Команда
.Ic folder
переключается на новый почтовый файл или папку.
Без
аргументов сообщает, какой файл вы сейчас читаете.
Если задать аргумент, она запишет внесённые изменения (такие
как удаления) в текущем файле и считает
новый файл.
Для имени
распознаются некоторые специальные обозначения:
.Ql #
означает предыдущий файл,
.Ql %
означает ваш системный почтовый ящик,
.Dq Li % Ns Ar пользователь
означает системный почтовый ящик пользователя,
.Ql &
означает ваш файл
.Pa mbox ,
а
.Dq Li + Ns Ar папка
означает файл в вашем каталоге
папок.
.It Ic from
.Pq Ic f
Принимает список сообщений и выводит их заголовки.
.It Ic headers
.Pq Ic h
Выводит текущий диапазон заголовков, который представляет собой группу из 18 сообщений.
Если задан аргумент
.Ql + ,
выводится следующая группа из 18 сообщений, а если задан
аргумент
.Ql \- ,
выводится предыдущая группа из 18 сообщений.
.It Ic help
Синоним для
.Ic \&? .
.It Ic hold
.Ic ( ho ,
также
.Ic preserve )
Принимает список сообщений и помечает каждое
сообщение в нём для сохранения в
системном почтовом ящике пользователя вместо файла
.Pa mbox .
Не отменяет действие команды
.Ic delete .
.It Ic ignore
Добавляет указанный список полей заголовка в
.Ar игнорируемый список .
Поля заголовка из списка игнорируемых не выводятся
на ваш терминал при выводе сообщения.
Эта
команда очень удобна для подавления некоторых автоматически создаваемых
полей заголовка.
Команды
.Ic Type
и
.Ic Print
могут использоваться для вывода сообщения полностью, включая
игнорируемые поля.
Если
.Ic ignore
выполняется без аргументов, она выводит текущий набор
игнорируемых полей.
.It Ic inc
Включает любые новые сообщения, поступившие во время чтения почты.
Новые сообщения добавляются в конец списка сообщений,
и текущее сообщение сбрасывается на первое новое почтовое сообщение.
Это не перенумеровывает существующий список сообщений и
не приводит к сохранению внесённых до сих пор изменений.
.It Ic mail
.Pq Ic m
Принимает в качестве аргументов имена пользователей и имена групп рассылки и отправляет
почту этим людям.
.It Ic mbox
Указывает, что список сообщений должен быть отправлен в
.Pa mbox
вашего домашнего каталога при выходе.
Это действие
по умолчанию для сообщений, если у вас
.Em не
установлена опция
.Ic hold .
.It Ic more
.Pq Ic mo
Принимает список сообщений и вызывает программу постраничного вывода для этого списка.
.It Ic next
.Ic ( n ,
как
.Ic +
или
.Tn CR )
Переходит к следующему сообщению в последовательности и выводит его.
С списком аргументов выводит следующее подходящее сообщение.
.It Ic preserve
.Pq Ic pre
Синоним для
.Ic hold .
.It Ic print
.Pq Ic p
Принимает список сообщений и выводит каждое сообщение на терминал пользователя.
.It Ic quit
.Pq Ic q
Завершает сеанс, сохраняя все неудалённые, несохранённые сообщения в
файле
.Pa mbox
пользователя в его домашнем каталоге, сохраняя все сообщения, помеченные
.Ic hold
или
.Ic preserve
или никогда не затрагивавшиеся,
в его системном почтовом ящике, и удаляя все остальные сообщения из его системного
почтового ящика.
Если во время сеанса поступила новая почта, выводится сообщение
.
Если выполнена во время редактирования
файла почтового ящика с флагом
.Fl f ,
то редактируемый файл перезаписывается.
Происходит возврат в оболочку,
если только перезапись редактируемого файла не завершится неудачей, в этом случае пользователь
может выйти с помощью команды
.Ic exit .
.It Ic reply
.Pq Ic r
Принимает список сообщений и отправляет почту отправителю и всем
получателям указанного сообщения.
Сообщение по умолчанию не должно быть удалено.
.It Ic respond
Синоним для
.Ic reply .
.It Ic retain
Добавляет указанный список полей заголовка в
Только поля заголовка из списка сохраняемых
показываются на вашем терминале при выводе сообщения.
Все остальные поля заголовка подавляются.
Команды
.Ic type
и
.Ic print
могут использоваться для вывода сообщения полностью.
Если
.Ic retain
выполняется без аргументов, она выводит текущий набор
сохраняемых полей.
.It Ic save
.Pq Ic s
Принимает список сообщений и имя файла и добавляет каждое сообщение по очереди
в конец файла.
Имя файла в кавычках, за которым следует количество строк
и количество символов, выводится на терминал пользователя.
.It Ic set
.Pq Ic se
Без аргументов выводит все значения переменных.
В противном случае устанавливает
опцию.
Аргументы имеют вид
.Ar опция Ns Li = Ns Ar значение
(без пробелов до или после
.Ql = )
или
.Ar опция .
Кавычки могут быть расставлены вокруг любой части оператора присваивания, чтобы
заключить пробелы или табуляции, т.е.\&
.It Ic saveignore
.Ic Saveignore
относится к
.Ic save
так же, как
.Ic ignore
относится к
.Ic print
и
.Ic type .
Поля заголовка, отмеченные таким образом, отфильтровываются при
сохранении сообщения с помощью
.Ic save
или при автоматическом сохранении в
.Pa mbox .
.It Ic saveretain
.Ic Saveretain
относится к
.Ic save
так же, как
.Ic retain
относится к
.Ic print
и
.Ic type .
Поля заголовка, отмеченные таким образом, являются единственными, сохраняемыми
с сообщением при сохранении с помощью
.Ic save
или при автоматическом сохранении в
.Pa mbox .
.Ic Saveretain
имеет приоритет над
.Ic saveignore .
.It Ic shell
.Pq Ic sh
Вызывает интерактивную версию оболочки.
.It Ic size
Принимает список сообщений и выводит размер каждого сообщения
в символах.
.It Ic source
Команда
.Ic source
читает
команды из файла.
.It Ic top
Принимает список сообщений и выводит первые несколько строк каждого.
Количество
выводимых строк контролируется переменной
.Va toplines
и по умолчанию равно 5.
.It Ic type
.Pq Ic t
Синоним для
.Ic print .
.It Ic unalias
Принимает список имён, определённых командами
.Ic alias ,
и отбрасывает запомненные группы пользователей.
Имена групп
больше не имеют никакого значения.
.It Ic undelete
.Pq Ic u
Принимает список сообщений и помечает каждое сообщение как
.Em не
удалённое.
.It Ic unread
.Pq Ic U
Принимает список сообщений и помечает каждое сообщение как
.Em не
прочитанное.
.It Ic unset
Принимает список имён опций и отбрасывает их запомненные значения;
инверсия команды
.Ic set .
.It Ic visual
.Pq Ic v
Принимает список сообщений и вызывает визуальный редактор для каждого сообщения.
.It Ic write
.Pq Ic w
Похожа на
.Ic save ,
но
.Em только
тело сообщения
.Em ( без
заголовка) сохраняется.
Чрезвычайно полезно для таких задач, как отправка и получение исходного
текста программ через почтовую систему.
.It Ic xit
.Pq Ic x
Синоним для
.Ic exit .
.It Ic z
Утилита
.Nm
представляет заголовки сообщений порциями, как описано в команде
.Ic headers .
Вы можете переместить
внимание
.Nm
вперёд к следующей порции с помощью команды
.Ic z .
Также можно перейти к предыдущей порции, используя
.Ic z\- .
.El
.Ss Тильда/Escape-последовательности
Вот сводка escape-последовательностей с тильдой,
которые используются при составлении сообщений для выполнения
специальных функций.
Escape-последовательности с тильдой распознаются только в начале
строк.
Название
несколько ошибочно, поскольку фактический escape-символ может быть задан
опцией
.Va escape .
.Bl -tag -width indent
.It Ic ~a
Вставляет строку автографа из опции sign= в сообщение.
.It Ic ~A
Вставляет строку автографа из опции Sign= в сообщение.
.It Ic ~b Ar имя ...
Добавляет данные имена в список получателей скрытых копий, но не делает
имена видимыми в строке Cc:
.Dq ( слепая
копия).
.It Ic ~c Ar имя ...
Добавляет данные имена в список получателей копий.
.It Ic ~d
Считывает файл
.Pa dead.letter
из вашего домашнего каталога в сообщение.
.It Ic ~e
Вызывает текстовый редактор для сообщения, собранного на данный момент.
После завершения
сеанса редактирования вы можете продолжить добавление текста к
сообщению.
.It Ic ~f Ar сообщения
Считывает указанные сообщения в отправляемое сообщение.
Если сообщения не указаны, считывает текущее сообщение.
Заголовки сообщений, которые в данный момент игнорируются (командами
.Ic ignore
или
.Ic retain ),
не включаются.
.It Ic ~F Ar сообщения
Идентично
.Ic ~f ,
но включаются все заголовки сообщений.
.It Ic ~h
Редактирует поля заголовка сообщения, запрашивая каждое по очереди и позволяя
пользователю добавлять текст в конец или изменять поле с помощью
текущих терминальных символов стирания и удаления.
.It Ic ~i Ar строка
Вставляет значение указанной опции в текст сообщения.
.It Ic ~m Ar сообщения
Считывает указанные сообщения в отправляемое сообщение, с отступом в виде
табуляции или значения
.Va indentprefix .
Если сообщения не указаны,
считывает текущее сообщение.
Заголовки сообщений, которые в данный момент игнорируются (командами
.Ic ignore
или
.Ic retain ),
не включаются.
.It Ic ~M Ar сообщения
Идентично
.Ic ~m ,
но включаются все заголовки сообщений.
.It Ic ~p
Выводит сообщение, собранное на данный момент, с предшествующими полями
заголовка.
.It Ic ~q
Прерывает отправку сообщения, копируя сообщение в
.Pa dead.letter
вашего домашнего каталога, если установлена опция
.Va save .
.It Ic ~r Ar файл , Ic ~r Li \&! Ns Ar команда
.It Ic ~< Ar файл , Ic ~< Li \&! Ns Ar команда
Считывает указанный файл в сообщение.
Если аргумент начинается с
.Ql \&! ,
оставшаяся часть строки воспринимается как произвольная системная команда и
выполняется, а стандартный вывод вставляется в сообщение.
.It Ic ~R Ar строка
Использовать
.Ar строку
в качестве поля Reply-To.
.It Ic ~s Ar строка
Делает указанную строку текущим полем темы.
.It Ic ~t Ar имя ...
Добавляет данные имена в список прямых получателей.
.It Ic ~v
Вызывает альтернативный редактор (определённый переменной окружения
.Ev VISUAL )
для
сообщения, собранного на данный момент.
Обычно альтернативный редактор будет
экранным редактором.
После выхода из редактора вы можете продолжить добавление
текста в конец вашего сообщения.
.It Ic ~w Ar файл
Записывает сообщение в указанный файл.
.It Ic ~x
Выходит, как при
.Ic ~q ,
но сообщение не сохраняется в
.Pa dead.letter .
.It Ic ~! Ar команда
Выполняет указанную команду оболочки, затем возвращается к сообщению.
.It Ic ~| Ar команда , Ic ~^ Ar команда
Пропускает сообщение через команду как через фильтр.
Если команда не
выдаёт вывод или завершается аномально, сохраняется исходный текст
сообщения.
Команда
.Xr fmt 1
часто используется в качестве
.Ar команды
для переформатирования сообщения.
.It Ic ~: Ar почтовая-команда , Ic ~_ Ar почтовая-команда
Выполняет указанную команду
.Nm .
Однако разрешены не все команды.
.It Ic ~.
Имитирует конец файла на вводе.
.It Ic ~?
Выводит сводку доступных escape-команд.
.It Ic ~~ Ar строка
Вставляет строку текста в сообщение, предваряя её одинарным
.Ql ~ .
Если
вы изменили escape-символ, то чтобы отправить его, нужно удвоить
этот символ.
.El
Опции могут быть установлены командой
.Ic set
и отключены командами
.Ic unset
или
.Ic set Cm no Ns Ar имя .
Опции могут быть двоичными, в таком случае важно только,
установлены они или нет; или строковыми, когда
важно фактическое значение.
Если опция не установлена,
.Nm
будет искать переменную окружения с тем же именем.
Доступные опции включают следующие:
.Bl -tag -width indent
.It Va append
При сохранении сообщений в
.Pa mbox
добавлять их в конец, а не в начало.
Эту опцию следует всегда устанавливать (предпочтительно в одном из общесистемных
файлов
.Pa mail.rc ).
По умолчанию
.Va noappend .
.It Va ask , asksub
Заставляет
.Nm
запрашивать тему каждого отправляемого вами сообщения.
Если
вы ответите просто переводом строки, поле темы отправлено не будет.
По умолчанию
.Va asksub .
.It Va askbcc
Запрашивает дополнительных получателей скрытых копий в конце
каждого сообщения.
Ответ переводом строки означает ваше
удовлетворение текущим списком.
По умолчанию
.Va noaskbcc .
.It Va askcc
Запрашивает дополнительных получателей копий в конце
каждого сообщения.
Ответ переводом строки означает ваше
удовлетворение текущим списком.
По умолчанию
.Va noaskcc .
.It Va autoinc
Автоматически включать новую почту по прибытии.
Установка этой опции аналогична выполнению команды
.Ic inc
при каждом приглашении, за исключением того, что текущее сообщение не
сбрасывается при поступлении новой почты.
По умолчанию
.Va noautoinc .
.It Va autoprint
Заставляет команду
.Ic delete
вести себя как
.Ic dp ;
таким образом, после удаления сообщения следующее будет автоматически
выведено.
По умолчанию
.Va noautoprint .
.It Va crt
Значение опции
.Va crt
используется как порог для определения, насколько длинным должно быть сообщение,
чтобы для его чтения использовался
.Ev PAGER .
Если
.Va crt
установлена без значения,
то используется высота экрана терминала, хранящаяся в системе,
для вычисления порога (см.
.Xr stty 1 ) .
По умолчанию
.Va nocrt .
.It Va debug
Установка двоичной опции
.Va debug
эквивалентна указанию
.Fl d
в командной строке и заставляет
.Nm
выводить различную информацию, полезную для отладки
.Nm .
В случае, если
.Nm
вызывается в этом режиме для отправки почты, все приготовления
будут выполнены и отчитаны, но почта
фактически отправлена не будет.
По умолчанию
.Va nodebug .
.It Va dot
Двоичная опция
.Va dot
заставляет
.Nm
интерпретировать точку, стоящую отдельно на строке, как признак
окончания отправляемого вами сообщения.
По умолчанию
.Va nodot .
.It Va escape
Если определена, первый символ этой опции задаёт символ, используемый
вместо
.Ql ~
для обозначения escape-последовательностей.
.It Va flipr
Меняет смысл команд
.Ic reply
и
.Ic Reply
на противоположный.
По умолчанию
.Va noflipr .
.It Va folder
Имя каталога для хранения папок с
сообщениями.
Если это имя начинается с
.Ql / ,
.Nm
считает его абсолютным путём; в противном случае каталог
папок ищется относительно вашего домашнего каталога.
.It Va header
Если определена, изначально отображает заголовки сообщений при чтении почты или
редактировании почтовой папки.
По умолчанию
.Va header .
Эту опцию можно отключить, указав флаг
.Fl N
в командной строке.
.It Va hold
Эта опция используется для удержания сообщений в системном почтовом ящике
по умолчанию.
По умолчанию
.Va nohold .
.It Va ignore
Заставляет игнорировать сигналы прерывания с вашего терминала и выводить их как
.Li @ .
По умолчанию
.Va noignore .
.It Va ignoreeof
Опция, связанная с
.Va dot , ignoreeof
заставляет
.Nm
отказываться принимать
.Aq Li control-D
как конец сообщения.
.Ar Ignoreeof
также применяется в
командном режиме
.Nm .
По умолчанию
.Va noignoreeof .
.It Va indentprefix
Строка, используемая escape-последовательностью
.Ic ~m
для отступа сообщений, вместо
обычного символа табуляции
.Pq Li ^I .
Обязательно заключайте значение в кавычки, если оно содержит
пробелы или табуляции.
.It Va metoo
Обычно при раскрытии группы, содержащей отправителя, отправитель
удаляется из раскрытия.
Установка этой опции приводит к включению отправителя
в группу.
По умолчанию
.Va nometoo .
.It Va quiet
Подавляет вывод версии при первом запуске.
По умолчанию
.Va noquiet .
.It Va record
Если определена, задаёт путь к файлу, используемому для записи всей исходящей
почты.
Если не определена, исходящая почта не сохраняется.
По умолчанию
.Va norecord .
.It Va Replyall
Меняет смысл команд
.Ic reply
и
.Ic Reply
на противоположный.
По умолчанию
.Va noReplyall .
.It Va save
Если эта опция установлена, и вы прерываете сообщение двумя
нажатиями
.Tn RUBOUT
(стирание или удаление),
.Nm
скопирует частичное письмо в файл
.Pa dead.letter
вашего домашнего каталога.
По умолчанию
.Va save .
.It Va searchheaders
Если эта опция установлена, то спецификатор списка сообщений вида
.Dq Li / Ns Ar x Ns : Ns Ar y
будет раскрываться во все сообщения, содержащие подстроку
.Ar y
в поле заголовка
.Ar x .
Поиск строки не чувствителен к регистру.
Если
.Ar x
опущено, по умолчанию используется поле заголовка
.Dq Li Subject .
Форма
.Dq Li /to: Ns Ar y
является особым случаем и будет раскрываться
во все сообщения, содержащие подстроку
.Ar y
в полях заголовка
.Dq Li To ,
.Dq Li Cc
или
.Dq Li Bcc .
Проверка для
регистрозависима, так что
.Dq Li /To: Ns Ar y
можно использовать для ограничения поиска
.Ar y
только полем
.Dq Li To: .
По умолчанию
.Va nosearchheaders .
.It Va toplines
Если определена, задаёт количество строк сообщения, выводимых
командой
.Ic top ;
обычно выводятся первые пять строк.
.It Va verbose
Установка опции
.Va verbose
эквивалентна использованию флага
.Fl v
в командной строке.
Когда
.Nm
работает в подробном режиме,
фактическая доставка сообщений отображается на терминале
пользователя.
По умолчанию
.Va noverbose .
.El
.Sh ОКРУЖЕНИЕ
.It Ev DEAD
Путь к файлу для сохранения частичных сообщений в случае прерываний
или ошибок доставки.
По умолчанию
.Pa ~/dead.letter .
.It Ev EDITOR
Путь к текстовому редактору, используемому в команде
.Ic edit
и escape-последовательности
.Ic ~e .
Если не определена, используется редактор по умолчанию.
.It Ev HOME
Путь к домашнему каталогу пользователя.
.It Ev LISTER
Путь к программе листинга каталогов, используемой в команде
.Ic folders .
По умолчанию
.Pa /bin/ls .
.It Ev MAIL
Расположение почтового ящика пользователя.
По умолчанию
.Pa /var/mail .
.It Ev MAILRC
Путь к файлу, содержащему начальные команды
.Nm .
По умолчанию
.Pa ~/.mailrc .
.It Ev MBOX
Имя файла почтового ящика.
Это может быть имя папки.
По умолчанию
.Pa mbox
в домашнем каталоге пользователя.
.It Ev PAGER
Путь к программе, используемой в команде
.Ic more
или когда установлена переменная
.Va crt .
Используется программа постраничного вывода по умолчанию
.Xr less 1 ,
если эта опция не определена.
.It Ev REPLYTO
Если установлена, будет использоваться для инициализации поля Reply-To для исходящих
сообщений.
.It Ev SHELL
Путь к оболочке, используемой в команде
.Ic \&!
и escape-последовательности
.Ic ~! .
Если эта опция не определена, используется оболочка по умолчанию.
.It Ev TMPDIR
Путь к каталогу, используемому для создания временных файлов.
.It Ev VISUAL
Путь к текстовому редактору, используемому в команде
.Ic visual
и escape-последовательности
.Ic ~v .
.It Ev USER
Имя пользователя, выполняющего mail.
.El
.Sh ФАЙЛЫ
.It Pa /var/mail/*
Почтовое отделение.
.It Pa ~/mbox
Старая почта пользователя.
.It Pa ~/.mailrc
Файл, содержащий начальные команды
.Nm .
Может быть переопределён установкой переменной окружения
.Ev MAILRC .
.It Pa /tmp/R*
Временные файлы.
.It Pa /usr/share/misc/mail.*help
Файлы справки.
.Pp
.It Pa /usr/share/misc/mail.rc
.It Pa /usr/local/etc/mail.rc
.It Pa /etc/mail.rc
Общесистемные файлы инициализации.
Каждый файл будет прочитан, по порядку,
если он существует.
.El
.Sh СМ. ТАКЖЕ
.Xr fmt 1 ,
.Xr newaliases 1 ,
.Xr vacation 1 ,
.Xr aliases 5 ,
.Xr sendmail 8
.Sh ИСТОРИЯ
Команда
.Nm
появилась в
.At v1 .
Эта man-страница основана на
оригинале, написанном
.An Kurt Shoens .
.Sh ИЗВЕСТНЫЕ ОШИБКИ
Некоторые флаги не документированы здесь.
Большинство из них
не полезны для обычного пользователя.
.Pp
Обычно
.Nm
является просто ссылкой на
.Nm Mail
и
.Nm mailx ,
что может сбивать с толку.
.Pp
Название списка
.Ic alternates
неправильное с точки зрения английского языка (должно быть
.Dq alternatives ) ,
но сохранено для совместимости.
