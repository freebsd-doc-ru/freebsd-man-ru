.\" Man page generated from reStructuredText.
.\" FRDP path ./usr.bin/clang/llvm-profdata/llvm-profdata.1
.\" FRDP githash a324c34037ef2e1101962fca4ad0c021253288e1
.\" FRDP hash256 9da7ae28c6aa9163dcdf4f599ec5e1a8f5c1fbeca1a04210d85a9aafce5ed8fb
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
..
.de UNINDENT
. RE
.nr rst2man-indent-level -1
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH ИМЯ
llvm-profdata \- Инструмент для работы с профильными данными
.SH СИНТАКСИС
.sp
\fBllvm\-profdata\fP \fIcommand\fP [\fIargs...\fP]
.SH ОПИСАНИЕ
.sp
Инструмент \fBllvm\-profdata\fP представляет собой небольшую утилиту для работы с файлами профильных данных.
.SH КОМАНДЫ
.INDENT 0.0
.IP \(bu 2
\fI\%merge\fP
.IP \(bu 2
\fI\%show\fP
.IP \(bu 2
\fI\%overlap\fP
.UNINDENT
.SH MERGE
.SS СИНТАКСИС
.sp
\fBllvm\-profdata merge\fP [\fIoptions\fP] [\fIfilename...\fP]
.SS ОПИСАНИЕ
.sp
Команда \fBllvm\-profdata merge\fP принимает несколько файлов профильных данных, сгенерированных инструментарием PGO, и объединяет их в один индексированный файл профильных данных.
.sp
По умолчанию данные профилей объединяются без изменений. Это означает, что относительная важность каждого входного файла пропорциональна количеству содержащихся в нем семплов или счетчиков. В общем случае, входные данные из более длительного прогона обучения будут интерпретированы как относительно более важные, чем из короткого. В зависимости от характера прогонов обучения может быть полезно скорректировать вес, присваиваемый каждому входному файлу, с помощью опции \fB\-weighted\-input\fP\.
.sp
Профили, переданные через \fB\-weighted\-input\fP, \fB\-input\-files\fP или через позиционные аргументы, обрабатываются один раз за каждое их появление.
.SS ОПЦИИ
.INDENT 0.0
.TP
.B \-\-help
Вывести краткую справку по параметрам командной строки.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-output=<output>, \-o
Указать имя выходного файла.  \fIOutput\fP не может быть \fB\-\fP, так как результирующие индексированные профильные данные не могут быть записаны в стандартный вывод.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-weighted\-input=<weight,filename>
Указать имя входного файла вместе с весом. Значения счетчиков профиля в указанном \fBfilename\fP будут масштабированы (умножены) на указанный \fBweight\fP, где \fBweight\fP \- целое десятичное число >= 1.
Входным файлам, указанным без использования этой опции, присваивается вес по умолчанию, равный 1. Примеры приведены ниже.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-input\-files=<path>, \-f
Указать файл, который содержит список файлов для объединения. Записи в этом файле разделены новой строкой. Строки, начинающиеся с \(aq#\(aq, пропускаются. Записи могут иметь вид <filename> или <weight>,<filename>.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-remapping\-file=<path>, \-r
Указать файл, который содержит сопоставление (remapping) имен символов во входном профиле с именами символов, которые должны использоваться в выходном профиле. Файл должен состоять из строк вида \fB<input\-symbol> <output\-symbol>\fP\.
Пустые строки и строки, начинающиеся с \fB#\fP, пропускаются.
.sp
Инструмент \fI\%llvm\-cxxmap\fP может быть использован для генерации файла сопоставления символов.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-instr (по умолчанию)
Указать, что входной профиль основан на инструментации.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-sample
Указать, что входной профиль основан на семплировании.
.sp
Формат генерируемого файла может быть создан одним из трех способов:
.INDENT 7.0
.TP
.B \-\-binary (по умолчанию)
.UNINDENT
.sp
Вывести профиль, используя бинарное кодирование. Для профиля, основанного на инструментации, выходной формат является индексированным бинарным форматом.
.INDENT 7.0
.TP
.B \-\-extbinary
.UNINDENT
.sp
Вывести профиль, используя расширяемое бинарное кодирование. Эта опция может использоваться только с профилем, основанным на семплировании. Расширяемое бинарное кодирование может быть более компактным при включенном сжатии и загружаться быстрее, чем кодирование по умолчанию.
.INDENT 7.0
.TP
.B \-\-text
.UNINDENT
.sp
Вывести профиль в текстовом режиме. Эта опция также может использоваться как с профилем на основе семплирования, так и с профилем на основе инструментации. При использовании этой опции профиль будет выведен в текстовом формате, который может быть проанализирован средством чтения профилей.
.INDENT 7.0
.TP
.B \-\-gcc
.UNINDENT
.sp
Вывести профиль, используя формат gcov GCC (пока не поддерживается).
.UNINDENT
.INDENT 0.0
.TP
.B \-\-sparse[=true|false]
Не выводить записи функций с нулевым счетчиком выполнения. Может использоваться только вместе с \-instr. По умолчанию false, так как это может препятствовать оптимизациям компилятора во время PGO.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-num\-threads=<N>, \-j
Использовать N потоков для выполнения объединения профилей. При N=0, llvm\-profdata автоматически определяет подходящее количество потоков для использования. Это поведение по умолчанию.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-failure\-mode=[any|all]
Установить режим отказа. Есть две опции: \(aqany\(aq приводит к сбою команды merge, если какой-либо из профилей невалиден, а \(aqall\(aq приводит к сбою команды merge, только если все профили невалидны. Если установлено \(aqall\(aq, информация из любых невалидных профилей исключается из конечного объединенного продукта. Режим отказа по умолчанию \- \(aqany\(aq.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-prof\-sym\-list=<path>
Указать файл, который содержит список символов для генерации списка символов профиля в профиле. Эта опция может использоваться только с профилем на основе семплирования в формате extbinary. Записи в этом файле разделены новой строкой.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-compress\-all\-sections=[true|false]
Сжимать все секции при записи профиля. Эта опция может использоваться только с профилем на основе семплирования в формате extbinary.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-use\-md5=[true|false]
Использовать MD5 для представления строк в таблице имен при записи профиля.
Эта опция может использоваться только с профилем на основе семплирования в формате extbinary.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-gen\-partial\-profile=[true|false]
Пометить профиль как частичный профиль, который обеспечивает только частичное покрытие профиля для оптимизированной цели. Эта опция может использоваться только с профилем на основе семплирования в формате extbinary.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-supplement\-instr\-with\-sample=<file>
Дополнить профиль инструментации семпловым профилем. Семпловый профиль является входным для этого флага. Выходные данные будут в формате инструментации (работает только с \-instr).
.UNINDENT
.INDENT 0.0
.TP
.B \-\-zero\-counter\-threshold=<float>
Для функции, которая является "холодной" в профиле инструментации, но "горячей" в семпловом профиле, если отношение количества нулевых счетчиков к общему количеству счетчиков превышает порог, профиль функции будет считаться вредным для производительности и будет отброшен.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-instr\-prof\-cold\-threshold=<int>
Заданный пользователем порог "холодности" для профиля инструментации, который переопределит порог "холодности", полученный из сводки профиля.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-suppl\-min\-size\-threshold=<int>
Если размер функции меньше порога, предполагается, что она может быть встроена (inlined) PGO early inliner и не будет корректироваться на основе семплового профиля.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-debug\-info=<path>
Указать исполняемый файл или \fB\&.dSYM\fP, который содержит отладочную информацию для сырого профиля.
Когда для инструментации использовался \fB\-debug\-info\-correlate\fP, используйте эту опцию для корреляции сырого профиля.
.UNINDENT
.SS ПРИМЕРЫ
.SS Базовое использование
.sp
Объединение трех профилей:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
llvm\-profdata merge foo.profdata bar.profdata baz.profdata \-output merged.profdata
.ft P
.fi
.UNINDENT
.UNINDENT
.SS Взвешенный ввод
.sp
Входной файл \fBfoo.profdata\fP особенно важен, умножить его счетчики на 10:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
llvm\-profdata merge \-\-weighted\-input=10,foo.profdata bar.profdata baz.profdata \-\-output merged.profdata
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Полностью эквивалентно предыдущему вызову (явная форма; полезна для программного вызова):
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
llvm\-profdata merge \-\-weighted\-input=10,foo.profdata \-\-weighted\-input=1,bar.profdata \-\-weighted\-input=1,baz.profdata \-\-output merged.profdata
.ft P
.fi
.UNINDENT
.UNINDENT
.SH SHOW
.SS СИНТАКСИС
.sp
\fBllvm\-profdata show\fP [\fIoptions\fP] [\fIfilename\fP]
.SS ОПИСАНИЕ
.sp
Команда \fBllvm\-profdata show\fP принимает файл профильных данных и отображает информацию о счетчиках профиля для этого файла и для любой из указанных функций.
.sp
Если \fIfilename\fP опущен или равен \fB\-\fP, то \fBllvm\-profdata show\fP читает ввод со стандартного ввода.
.SS ОПЦИИ
.INDENT 0.0
.TP
.B \-\-all\-functions
Вывести подробности для каждой функции.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-binary\-ids
Вывести встроенные идентификаторы бинарных файлов (binary ids) в профиле.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-counts
Вывести значения счетчиков для отображаемых функций.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-show\-format=<text|json|yaml>
Вывести результат в выбранном формате, если он поддерживается предоставленным типом профиля.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-function=<string>
Вывести подробности для функции, если имя функции содержит данную строку.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-help
Вывести краткую справку по параметрам командной строки.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-output=<output>, \-o
Указать имя выходного файла.  Если \fIoutput\fP равен \fB\-\fP или не указан, то вывод отправляется на стандартный вывод.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-instr (по умолчанию)
Указать, что входной профиль основан на инструментации.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-text
Указать средству вывода профилей отображать счетчики профиля в текстовом формате представления данных профиля, основанного на инструментации. По умолчанию информация профиля выводится в более удобочитаемой форме (также в тексте) с аннотациями.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-topn=<n>
Указать средству вывода профилей показать топ-\fBn\fP функций с самыми "горячими" базовыми блоками в разделе сводки. По умолчанию функции topn не выводятся.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-sample
Указать, что входной профиль основан на семплировании.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-memop\-sizes
Показать профилируемые размеры вызовов встроенных функций работы с памятью (memory intrinsic calls) для показанных функций.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-value\-cutoff=<n>
Показать только те функции, максимальные значения счетчиков которых больше или равны \fBn\fP\.
По умолчанию value\-cutoff установлен в 0.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-list\-below\-cutoff
Выводить только имена функций, максимальное значение счетчика которых ниже порогового значения.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-profile\-version
Вывести версию профиля.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-showcs
Показывать только контекстно-зависимые счетчики профиля. По умолчанию все контекстно-зависимые счетчики профиля фильтруются.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-show\-prof\-sym\-list=[true|false]
Показать список символов профиля, если он существует в профиле. Эта опция имеет смысл только для профиля на основе семплирования в формате extbinary.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-show\-sec\-info\-only=[true|false]
Показать базовую информацию о каждой секции в профиле. Эта опция имеет смысл только для профиля на основе семплирования в формате extbinary.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-debug\-info=<path>
Указать исполняемый файл или \fB\&.dSYM\fP, который содержит отладочную информацию для сырого профиля.
Когда для инструментации использовался \fB\-debug\-info\-correlate\fP, используйте эту опцию для показа коррелированных функций из сырого профиля.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-covered
Показать только функции, которые были выполнены, т.е. функции с ненулевыми счетчиками.
.UNINDENT
.SH OVERLAP
.SS СИНТАКСИС
.sp
\fBllvm\-profdata overlap\fP [\fIoptions\fP] [\fIбазовый файл профиля\fP] [\fIтестовый файл профиля\fP]
.SS ОПИСАНИЕ
.sp
Команда \fBllvm\-profdata overlap\fP принимает два файла профильных данных и отображает \fIперекрытие\fP распределения счетчиков между файлами целиком и между любыми из указанных функций.
.sp
В этой команде \fIперекрытие\fP определяется следующим образом:
Предположим, \fIбазовый файл профиля\fP имеет следующие счетчики:
{c1_1, c1_2, ..., c1_n, c1_u_1, c2_u_2, ..., c2_u_s},
а \fIтестовый файл профиля\fP имеет
{c2_1, c2_2, ..., c2_n, c2_v_1, c2_v_2, ..., c2_v_t}.
Здесь c{1|2}_i (i = 1 .. n) - это сопоставленные счетчики, а c1_u_i (i = 1 .. s) и c2_v_i (i = 1 .. v) - несопоставленные счетчики (или счетчики, существующие только в) \fIбазовом файле профиля\fP и \fIтестовом файле профиля\fP, соответственно.
Пусть sum_1 = c1_1 + c1_2 +  ... + c1_n +  c1_u_1 + c2_u_2 + ... + c2_u_s, и
sum_2 = c2_1 + c2_2 + ... + c2_n + c2_v_1 + c2_v_2 + ... + c2_v_t.
\fIперекрытие\fP = min(c1_1/sum_1, c2_1/sum_2) + min(c1_2/sum_1, c2_2/sum_2) + ...
+ min(c1_n/sum_1, c2_n/sum_2).
.sp
Результирующее распределение перекрытия выражается в процентах, от 0.0% до 100.0%, где 0.0% означает отсутствие перекрытия, а 100.0% означает идеальное перекрытие.
.sp
Вот пример: если \fIбазовый файл профиля\fP имеет счетчики {400, 600}, а \fIтестовый файл профиля\fP имеет сопоставленные счетчики {60000, 40000}. \fIПерекрытие\fP составляет 80%.
.SS ОПЦИИ
.INDENT 0.0
.TP
.B \-\-function=<string>
Вывести подробности для функции, если имя функции содержит данную строку.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-help
Вывести краткую справку по параметрам командной строки.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-output=<output>, \-o
Указать имя выходного файла.  Если \fIoutput\fP равен \fB\-\fP или не указан, то вывод отправляется на стандартный вывод.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-value\-cutoff=<n>
Показать только те функции, максимальные значения счетчиков которых больше или равны \fBn\fP\.
По умолчанию value\-cutoff установлен в максимум для unsigned long long.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-cs
Показывать перекрытие только для контекстно-зависимых счетчиков профиля. По умолчанию показываются неконтекстно-зависимые счетчики профиля.
.UNINDENT
.SH СТАТУС ВЫХОДА
.sp
\fBllvm\-profdata\fP возвращает 1, если команда опущена или недействительна, если он не может прочитать входные файлы или если есть несоответствие между их данными.
.SH АВТОРЫ
Поддерживается командой LLVM (https://llvm.org/).
.SH АВТОРСКИЕ ПРАВА
2003-2023, LLVM Project
