.\" Copyright (c) 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" the Institute of Electrical and Electronics Engineers, Inc.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @(#)tr.1	8.1 (Berkeley) 6/6/93
.\"
.\" FRDP path ./usr.bin/tr/tr.1
.\" FRDP githash bdcbfde31e8e9b343f113a1956384bdf30d1ed62
.\" FRDP hash256 3f9d307c34f489363f53a5bed177a5a49cd42999d3a373ba6a9c4d9b53f6d3a6
.Dd 13 октября 2006
.Dt TR 1
.Os
.Sh ИМЯ
.Nm tr
.Nd транслировать символы
.Sh СИНТАКСИС
.Nm
.Op Fl Ccsu
.Ar строка1 строка2
.Nm
.Op Fl Ccu
.Fl d
.Ar строка1
.Nm
.Op Fl Ccu
.Fl s
.Ar строка1
.Nm
.Op Fl Ccu
.Fl ds
.Ar строка1 строка2
.Sh ОПИСАНИЕ
Утилита
.Nm
копирует стандартный ввод на стандартный вывод с заменой
или удалением выбранных символов.
.Pp
Доступны следующие опции:
.Bl -tag -width Ds
.It Fl C
Дополнить набор символов в
.Ar строке1 ,
то есть
.Dq Fl C Li ab
включает каждый символ, кроме
.Ql a
и
.Ql b .
.It Fl c
То же, что и
.Fl C ,
но дополнить набор значений в
.Ar строке1 .
.It Fl d
Удалить символы из
.Ar строки1
из входных данных.
.It Fl s
Сжать множественные вхождения символов, перечисленных в последнем
операнде (либо
.Ar строка1 ,
либо
.Ar строка2 ),
во входных данных в один экземпляр символа.
Это происходит после завершения всех удалений и трансляций.
.It Fl u
Гарантировать, что любой вывод не буферизируется.
.El
.Pp
В первой форме синтаксиса символы в
.Ar строке1
транслируются в символы в
.Ar строке2 ,
где первый символ в
.Ar строке1
транслируется в первый символ в
.Ar строке2
и так далее.
Если
.Ar строка1
длиннее, чем
.Ar строка2 ,
последний найденный символ в
.Ar строке2
дублируется, пока не будет исчерпана
.Ar строка1 .
.Pp
Во второй форме синтаксиса символы в
.Ar строке1
удаляются из входных данных.
.Pp
В третьей форме синтаксиса символы в
.Ar строке1
сжимаются, как описано для опции
.Fl s .
.Pp
В четвёртой форме синтаксиса символы в
.Ar строке1
удаляются из входных данных, а символы в
.Ar строке2
сжимаются, как описано для опции
.Fl s .
.Pp
В
.Ar строке1
и
.Ar строке2
можно использовать следующие соглашения для
определения наборов символов:
.Bl -tag -width [:equiv:]
.It символ
Любой символ, не описанный следующими соглашениями,
представляет сам себя.
.It \eвосьмеричный
Обратная косая черта, за которой следуют 1, 2 или 3 восьмеричные цифры,
представляет символ
с этим закодированным значением.
Чтобы после восьмеричной последовательности шел цифровой символ,
дополните восьмеричную последовательность слева нулями до полных 3 восьмеричных цифр.
.It \eсимвол
Обратная косая черта, за которой следуют определённые специальные символы,
отображается на специальные
значения.
.El
.Pp
Обратная косая черта, за которой следует любой другой символ, отображается на этот символ.
.It c-c
Для невосьмеричных конечных точек диапазона
представляет диапазон символов между конечными точками, включительно,
в порядке возрастания,
как определено последовательностью сортировки.
Если одна или обе конечные точки диапазона являются восьмеричными последовательностями,
это представляет диапазон конкретных закодированных значений между
конечными точками диапазона, включительно.
.Pp
.Bf Em
Смотрите раздел
.Sx СОВМЕСТИМОСТЬ
ниже для важного примечания относительно
различий в том, как текущая реализация интерпретирует выражения диапазона по сравнению с
предыдущими реализациями.
.Ef
.It [:класс:]
Представляет все символы, принадлежащие определённому классу символов.
Имена классов:
.El
.Pp
Когда
.Dq Li [:lower:]
появляется в
.Ar строке1
и
.Dq Li [:upper:]
появляется в той же относительной позиции в
.Ar строке2 ,
это представляет пары символов из
отображения
.Dv toupper
в категории
.Ev LC_CTYPE
текущей локали.
Когда
.Dq Li [:upper:]
появляется в
.Ar строке1
и
.Dq Li [:lower:]
появляется в той же относительной позиции в
.Ar строке2 ,
это представляет пары символов из
отображения
.Dv tolower
в категории
.Ev LC_CTYPE
текущей локали.
.Pp
За исключением преобразования регистра,
символы в классах находятся в неуказанном порядке.
.Pp
Для конкретной информации о том, какие
.Tn ASCII
символы включены
в эти классы, смотрите
.Xr ctype 3
и связанные справочные страницы.
.It [=equiv=]
Представляет все символы, принадлежащие тому же классу эквивалентности, что и
.Ar equiv ,
упорядоченные по их закодированным значениям.
.It [#*n]
Представляет
.Ar n
повторяющихся вхождений символа, представленного
.Ar # .
Это выражение действительно только тогда, когда оно встречается в
.Ar строке2 .
Если
.Ar n
опущено или равно нулю, оно интерпретируется как достаточно большое, чтобы расширить
последовательность
.Ar строки2
до длины
.Ar строки1 .
Если
.Ar n
имеет ведущий ноль, оно интерпретируется как восьмеричное значение, в противном случае
интерпретируется как десятичное значение.
.El
.Sh ОКРУЖЕНИЕ
Переменные окружения
.Ev LANG , LC_ALL , LC_CTYPE
и
.Ev LC_COLLATE
влияют на выполнение
.Nm ,
как описано в
.Xr environ 7 .
.Sh СТАТУС ВЫХОДА
.Ex -std
.Sh ПРИМЕРЫ
Следующие примеры показаны так, как они передаются оболочке:
.Pp
Создать список слов из файла file1, по одному на строку, где слово считается
максимальной строкой букв.
.Pp
.Pp
Перевести содержимое файла file1 в верхний регистр.
.Pp
.Pp
(Этому следует отдавать предпочтение перед традиционной
.Ux
идиомой
так как это работает корректно во всех локалях.)
.Pp
Удалить непечатаемые символы из файла file1.
.Pp
.Pp
Удалить диакритические знаки у всех акцентированных вариантов буквы
.Ql e :
.Pp
.Sh СОВМЕСТИМОСТЬ
Предыдущие реализации
.Fx
утилиты
.Nm
не упорядочивали символы в выражениях диапазона в соответствии с
порядком сортировки текущей локали, что позволяло преобразовывать латинские символы без диакритики (особенно встречающиеся в английском тексте) из верхнего регистра в нижний, используя
традиционную
.Ux
идиому
Так как теперь
.Nm
соблюдает порядок сортировки локали, эта идиома может давать некорректные результаты, когда нет взаимно-однозначного соответствия между нижним и
верхним регистром, или когда порядок символов в двух регистрах различается.
Как отмечено в разделе
.Sx ПРИМЕРЫ
выше, вместо явных диапазонов символов, таких как
.Dq Li a-z
и
.Dq Li A-Z ,
следует использовать выражения классов символов
.Dq Li [:lower:]
и
.Dq Li [:upper:] .
.Pp
Выражение
.Dq Li [=equiv=]
и сортировка для диапазонов
реализованы только для однобайтовых локалей.
.Pp
System V исторически реализовывал диапазоны символов, используя синтаксис
.Dq Li [c-c]
вместо
.Dq Li c-c ,
используемого историческими реализациями
.Bx
и стандартизированного POSIX.
Скрипты System V должны работать под этой реализацией, пока
диапазон предназначен для отображения в другой диапазон, т.е. команда
будет работать, так как она отобразит символ
.Ql \&[
в
.Ar строке1
на символ
.Ql \&[
в
.Ar строке2 .
Однако, если скрипт удаляет или сжимает символы, как в команде
символы
.Ql \&[
и
.Ql \&]
будут
включены в список удаления или сжатия, чего не происходило бы
в исторической реализации System V.
Кроме того, любые скрипты, которые полагались на последовательность
.Dq Li a-z
для
представления трёх символов
.Ql a ,
.Ql \-
и
.Ql z ,
придётся
переписать как
.Dq Li a\e-z .
.Pp
Утилита
.Nm
исторически не позволяла манипулировать байтами NUL в
своих входных данных и, кроме того, удаляла NUL'ы из своего входного потока.
Данная реализация устранила это поведение как ошибку.
.Pp
Утилита
.Nm
исторически была чрезвычайно снисходительной к синтаксическим ошибкам,
например, опции
.Fl c
и
.Fl s
игнорировались, если не были указаны две строки.
Данная реализация не допускает недопустимый синтаксис.
.Sh СТАНДАРТЫ
Утилита
.Nm
соответствует стандарту
.St -p1003.1-2001 .
Классы символов
.Dq ideogram ,
.Dq phonogram ,
.Dq rune ,
и
.Dq special
являются расширениями.
.Pp
Следует отметить, что возможность, при которой последний символ
.Ar строки2
дублируется, если
.Ar строка2
имеет меньше символов, чем
.Ar строка1 ,
разрешена POSIX, но не требуется.
Скрипты оболочки, пытающиеся быть переносимыми на другие POSIX-системы, должны использовать
соглашение
.Dq Li [#*]
вместо того, чтобы полагаться на это поведение.
Опция
.Fl u
является расширением стандарта
.St -p1003.1-2001 .
