.\" Copyright (c) 1987, 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @(#)ctags.1	8.1 (Berkeley) 6/6/93
.\"
.\" FRDP path ./usr.bin/ctags/ctags.1
.\" FRDP githash bdcbfde31e8e9b343f113a1956384bdf30d1ed62
.\" FRDP hash256 eb0bbe60b0d78ba3a08e3c40a900cb338ef222cbd65bbdc4bad873a8c9ebd6c4
.Dd 23 мая 2023
.Dt CTAGS 1
.Os
.Sh ИМЯ
.Nm ctags
.Nd создаёт файл
.Pa tags
.Sh СИНТАКСИС
.Nm
.Op Fl BFTaduwvx
.Op Fl f Ar файл_тегов
.Ar
.Sh ОПИСАНИЕ
Утилита
.Nm
создаёт файл
.Pa tags
для
.Xr ex 1
из указанных исходных кодов на C,
Паскале, Фортран,
.Xr yacc 1 ,
.Xr lex 1
и Лиспе.
Файл тегов указывает расположение определённых объектов в группе файлов.
Каждая строка файла тегов содержит имя объекта, файл, в котором он
определён, и шаблон поиска для определения объекта, разделённые
пробелами.
Используя файл
.Pa tags ,
.Xr ex 1
может быстро находить эти определения объектов.
В зависимости от предоставленных
.Nm
опций, объектами будут подпрограммы, определения типов (typedef), директивы define, структуры,
перечисления (enum) и объединения (union).
.Pp
Доступны следующие опции:
.Bl -tag -width indent
.It Fl B
Использовать шаблоны поиска назад
.Pq Li ?...? .
.It Fl F
Использовать шаблоны поиска вперёд
.Pq Li /.../
(по умолчанию).
.It Fl T
Не создавать теги для typedef, структур, объединений и перечислений.
.It Fl a
Дописать в файл
.Pa tags .
.It Fl d
Создавать теги для
.Li #define ,
которые не принимают аргументов;
.Li #define ,
принимающие аргументы, помечаются автоматически.
.It Fl f
Поместить описания тегов в файл с именем
.Ar файл_тегов .
Поведение по умолчанию — помещать их в файл с именем
.Pa tags .
Если
.Ar файл_тегов
—
.Dq - ,
теги будут выведены в стандартный вывод.
.It Fl u
Обновить указанные файлы в файле
.Pa tags ,
то есть все
ссылки на них удаляются, а новые значения добавляются в
файл.
Это игнорируется, если файл тегов не существует или не является обычным
файлом (например, использовалась опция
.Fl f Ns -
для вывода в стандартный вывод).
.Pp
Внимание: эта опция реализована довольно
медленно; обычно быстрее просто перестроить файл
.Pa tags .
.It Fl v
Индекс в форме, ожидаемой
.Xr vgrind 1 ,
выводится в стандартный вывод.
Этот список
содержит имя объекта, имя файла и номер страницы (в предположении 64
строк на страницу).
Поскольку вывод будет отсортирован в лексикографическом порядке,
может потребоваться пропустить вывод через
.Xr sort 1 .
Пример использования:
.Bd -literal -offset indent
ctags -v файлы | sort -f > index
vgrind -x index
.Ed
.It Fl w
Подавлять предупреждения.
.It Fl x
.Nm
выводит список имён объектов,
номер строки и имя файла, в котором каждый определён, а также
текст этой строки и печатает это в стандартный вывод.
Это
простой индекс, который может быть распечатан как читаемый автономно
индекс функций.
.El
.Pp
Предполагается, что файлы, имена которых заканчиваются на
.Pa .c
или
.Pa .h ,
являются исходными файлами на C, и в них ищутся определения подпрограмм и макросов в стиле C.
Предполагается, что файлы, имена которых заканчиваются на
.Pa .y ,
являются исходными файлами
.Xr yacc 1 .
Предполагается, что файлы, имена которых заканчиваются на
.Pa .l ,
являются файлами на Лиспе, если их
первый непустой символ —
.Ql \&; ,
.Ql \&( ,
или
.Ql \&[ ;
в противном случае они
трактуются как файлы
.Xr lex 1 .
Другие файлы сначала проверяются на наличие
определений подпрограмм на Паскале или Фортране, и, если их нет,
в них ищутся определения в стиле C.
.Pp
Тег
.Dq Li main
обрабатывается в программах на C особым образом.
Создаваемый тег
формируется путём добавления префикса
.Ql M
к имени файла, с удалением
суффикса
.Pa .c
и любых ведущих компонентов пути.
Это делает использование
.Nm
практичным в каталогах с более чем одной
программой.
.Pp
Файлы
.Xr yacc 1
и
.Xr lex 1
имеют специальные теги.
.Dq Li yyparse
— это начало
второй секции файла
.Xr yacc 1 ,
а
.Dq Li yylex
— начало
второй секции файла
.Xr lex 1 .
.Sh ФАЙЛЫ
.It Pa tags
файл тегов по умолчанию
.El
.Sh СТАТУС ВЫХОДА
Утилита
.Nm
завершается со значением 1, если произошла ошибка, и 0 в противном случае.
Повторяющиеся объекты не считаются ошибками.
.Sh СОВМЕСТИМОСТЬ
Опция
.Fl t
не имеет эффекта (no-op) для совместимости с предыдущими версиями
.Nm ,
которые по умолчанию не создавали теги для typedef, перечислений, структур и объединений.
.Sh СМ. ТАКЖЕ
.Xr ex 1 ,
.Xr vi 1
.Sh СТАНДАРТЫ
Утилита
.Nm
соответствует
.St -p1003.1-2001 .
.Sh ИСТОРИЯ
Утилита
.Nm
появилась в
.Bx 3.0 .
.Sh ИЗВЕСТНЫЕ ОШИБКИ
Распознавание функций, подпрограмм и процедур
для Фортрана и Паскаля выполняется очень упрощённо.
Не делается
никаких попыток работать со структурой блоков; если у вас есть две процедуры Паскаля
в разных блоках с одинаковым именем, вы теряете.
Утилита
.Nm
не
понимает типы Паскаля.
.Pp
Метод определения, искать ли функции C, Паскаля или
Фортран,
— это костыль (hack).
.Pp
Утилита
.Nm
полагается на корректность входных данных, и любые синтаксические
ошибки полностью собьют её с толку.
Она также находит некоторые корректные синтаксические конструкции
запутанными; например, поскольку она не понимает
.Li #ifdef
(кстати, это особенность, а не ошибка), любой код с несбалансированными
фигурными скобками внутри
.Li #ifdef
заставит её несколько дезориентироваться.
Аналогичным образом, многострочные изменения внутри определения
приведут к тому, что в качестве шаблона поиска будет использована последняя строка объекта, а не
первая.
Аналогичным образом будет отмечена последняя строка многострочных
.Li typedef .
