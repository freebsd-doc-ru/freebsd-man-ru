.\" Copyright (c) 1989, 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" the Institute of Electrical and Electronics Engineers, Inc.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@(#)printf.1	8.1 (Berkeley) 6/6/93
.\"
.\" FRDP path ./usr.bin/printf/printf.1
.\" FRDP githash bdcbfde31e8e9b343f113a1956384bdf30d1ed62
.\" FRDP hash256 f5e4d0ce1c7ce42ea629a9d6b975daebfe1f9fecab05707891e8f67ebc53aec1
.Dd 1 июля 2020
.Dt PRINTF 1
.Os
.Sh ИМЯ
.Nm printf
.Nd форматированный вывод
.Sh СИНТАКСИС
.Nm
.Ar формат Op Аргументы ...
.Sh ОПИСАНИЕ
Утилита
.Nm
форматирует и выводит свои аргументы, начиная со второго, под управлением
.Ar формата .
.Ar Формат
— это строка символов, содержащая три типа объектов: простые символы,
которые просто копируются в стандартный вывод; escape-последовательности символов, которые
преобразуются и копируются в стандартный вывод; и спецификации формата,
каждая из которых вызывает печать следующего очередного
.Ar аргумента .
.Pp
.Ar Аргументы
после первого обрабатываются как строки, если соответствующий формат —
это
.Cm c , b
или
.Cm s ;
иначе они вычисляются как константа языка C, со следующими расширениями:
.Pp
.Bl -bullet -offset indent -compact
.It
Разрешается ведущий знак плюс или минус.
.It
Если ведущий символ — одинарная или двойная кавычка, значением является
код символа следующего символа.
.El
.Pp
Строка формата используется повторно столько раз, сколько необходимо для удовлетворения всех
.Ar аргументов .
Любые лишние спецификации формата вычисляются с нулём или пустой строкой.
.Pp
Escape-последовательности символов используют обратно-слэшовую нотацию, определённую в
.St -ansiC ,
с расширениями.
Символы и их значения
следующие:
.Pp
.Bl -tag -width Ds -offset indent -compact
.It Cm \ea
Вывести символ <звонок>.
.It Cm \eb
Вывести символ <забой>.
.It Cm \ef
Вывести символ <перевод формата>.
.It Cm \en
Вывести символ <новая строка>.
.It Cm \er
Вывести символ <возврат каретки>.
.It Cm \et
Вывести символ <табуляция>.
.It Cm \ev
Вывести символ <вертикальная табуляция>.
.It Cm \e\'
Вывести символ <одинарная кавычка>.
.It Cm \e\e
Вывести символ обратной косой черты.
.It Cm \e Ns Ar число
Вывести байт,
значение которого соответствует 1-, 2- или 3-значному
восьмеричному числу
.Ar число .
Многобайтовые символы могут быть сконструированы с использованием нескольких
последовательностей
.Cm \e Ns Ar число .
.El
.Pp
Каждая спецификация формата вводится символом процента
(``%'').
Оставшаяся часть спецификации формата включает,
в следующем порядке:
.Bl -tag -width Ds
.Bl -tag -width Ds
.It Cm #
Символ `#',
указывающий, что значение должно быть выведено в ``альтернативной форме''.
Для форматов
.Cm b , c , d , s
и
.Cm u
эта опция не имеет эффекта.
Для формата
.Cm o
точность числа увеличивается, чтобы принудительно вывести первый
символ выходной строки как ноль.
Для формата
.Cm x
.Pq Cm X
ненулевой результат получает строку
.Li 0x
.Pq Li 0X
в начале.
Для форматов
.Cm a , A , e , E , f , F , g
и
.Cm G
результат всегда будет содержать десятичную точку, даже если за
точкой не следует цифр (обычно десятичная точка появляется в
результатах этих форматов только если после десятичной точки следует цифра).
Для форматов
.Cm g
и
.Cm G
конечные нули не удаляются из результата, как это
происходило бы в противном случае;
.It Cm \&\-
Знак минуса `\-', указывающий
.Em выравнивание влево
вывода в указанном поле;
.It Cm \&+
Символ `+', указывающий, что знак всегда должен
размещаться перед числом при использовании знаковых форматов.
.It Sq \&\ \&
Пробел, указывающий, что перед положительным числом
для знакового формата должен оставаться пробел.
Символ `+' переопределяет пробел, если используются оба;
.It Cm \&0
Символ нуля `0', указывающий, что должно использоваться
дополнение нулями вместо дополнения пробелами.
Символ `\-' переопределяет `0', если используются оба;
.El
Необязательная строка цифр, задающая
.Em ширину поля ;
если выходная строка содержит меньше байт, чем ширина поля, она будет
дополнена пробелами слева (или справа, если указан индикатор выравнивания влево)
до достижения ширины поля (обратите внимание, что ведущий ноль
является флагом, а встроенный ноль — частью ширины поля);
.It Точность:
Необязательная точка,
.Sq Cm \&.\& ,
за которой следует необязательная строка цифр, задающая
.Em точность ,
которая определяет количество цифр после десятичной точки
для форматов
.Cm e
и
.Cm f
или максимальное количество байт для вывода
из строки; если строка цифр отсутствует, точность рассматривается
как ноль;
.It Формат:
Символ, указывающий тип используемого формата (один из
.Cm diouxXfFeEgGaAcsb ) .
Форматы в верхнем регистре отличаются от своих аналогов в нижнем регистре только тем,
что вывод первых полностью в верхнем регистре.
Спецификаторы формата с плавающей точкой
.Pq Cm fFeEgGaA
могут быть предварены символом
.Cm L
для запроса дополнительной точности, если она доступна.
.El
.Pp
Ширина поля или точность может быть
.Sq Cm \&*
вместо строки цифр.
В этом случае
.Ar аргумент
предоставляет ширину поля или точность.
.Pp
Символы формата и их значения:
.Bl -tag -width Fl
.It Cm diouXx
.Ar Аргумент
выводится как знаковое десятичное (d или i), беззнаковое восьмеричное, беззнаковое десятичное
или беззнаковое шестнадцатеричное (X или x) соответственно.
.It Cm fF
.Ar Аргумент
выводится в стиле `[\-]ddd.ddd', где количество d
после десятичной точки равно спецификации точности для
аргумента.
Если точность отсутствует, выводится 6 цифр; если точность
явно равна 0, цифры и десятичная точка не выводятся.
Значения \*[If] и \*[Na] выводятся как
.Ql inf
и
.Ql nan
соответственно.
.It Cm eE
.Ar Аргумент
выводится в стиле
.Cm e
.Sm off
.Sq Op - Ar d.ddd No \(+- Ar dd
.Sm on
где
есть одна цифра перед десятичной точкой, а число после равно
спецификации точности для аргумента; когда точность
отсутствует, создаётся 6 цифр.
Значения \*[If] и \*[Na] выводятся как
.Ql inf
и
.Ql nan
соответственно.
.It Cm gG
.Ar Аргумент
выводится в стиле
.Cm f
.Pq Cm F
или в стиле
.Cm e
.Pq Cm E
в зависимости от того, что даёт полную точность в минимальном пространстве.
.It Cm aA
.Ar Аргумент
выводится в стиле
.Sm off
.Sq Op - Ar h.hhh No \(+- Li p Ar d
.Sm on
где есть одна цифра перед шестнадцатеричной точкой, а число
после равно спецификации точности для аргумента;
когда точность отсутствует, выводится достаточно цифр для передачи
точного представления аргумента с двойной точностью с плавающей точкой.
Значения \*[If] и \*[Na] выводятся как
.Ql inf
и
.Ql nan
соответственно.
.It Cm c
Выводится первый байт
.Ar аргумента .
.It Cm s
Байты из строки
.Ar аргумента
выводятся до достижения конца строки или до достижения количества байт,
указанного спецификацией точности; однако если
точность равна 0 или отсутствует, строка выводится полностью.
.It Cm b
Как для
.Cm s ,
но интерпретирует escape-последовательности в строке
.Ar аргумент
в обратно-слэшовой нотации.
Разрешённые escape-последовательности несколько отличаются: восьмеричные escape-последовательности имеют вид
.Cm \e0 Ns Ar число
вместо
.Cm \e Ns Ar число
и дополнительная escape-последовательность
.Cm \ec
останавливает дальнейший вывод от данного вызова
.Nm .
.It Cm n$
Позволяет переупорядочивать вывод в соответствии с
.Ar аргументом .
.It Cm \&%
Вывести символ `%'; аргумент не используется.
.El
.Pp
Символ десятичной точки
определяется в локали программы (категория
.Dv LC_NUMERIC ) .
.Pp
Ни в коем случае несуществующая или малая ширина поля не вызывает усечения
поля; дополнение происходит только если указанная ширина поля превышает
фактическую ширину.
.Pp
Некоторые оболочки могут предоставлять встроенную команду
.Nm ,
которая похожа или идентична этой утилите.
Обратитесь к справочной странице
.Xr builtin 1 .
.Sh СТАТУС ВЫХОДА
.Ex -std
.Sh ПРИМЕРЫ
Вывести строку
.Qq hello :
.Bd -literal -offset indent
hello
.Ed
.Pp
То же, что и выше, но обратите внимание, что строка формата не заключена в кавычки, и поэтому мы
не получаем ожидаемого поведения:
.Bd -literal -offset indent
$ printf %s\en hello
hellon$
.Ed
.Pp
Вывести аргументы, принудительно добавляя знак только для первого аргумента:
.Bd -literal -offset indent
+1
-2
13
.Ed
.Pp
То же, что и выше, но единая строка формата будет применена к трём
аргументам:
.Bd -literal -offset indent
+1
-2
+13
.Ed
.Pp
Вывести число, используя только две цифры после десятичной точки:
.Bd -literal -offset indent
31.75
.Ed
.Sh СОВМЕСТИМОСТЬ
Традиционное поведение
.Bx ,
преобразующее аргументы числовых форматов, не начинающихся
с цифры, в код ASCII
первого символа, не поддерживается.
.Sh СМ. ТАКЖЕ
.Xr builtin 1 ,
.Xr echo 1 ,
.Xr sh 1 ,
.Xr printf 3
.Sh СТАНДАРТЫ
Ожидается, что команда
.Nm
совместима со спецификацией
.St -p1003.2 .
.Sh ИСТОРИЯ
Команда
.Nm
появилась в
.Bx 4.3 Reno .
Она создана по образцу
стандартной библиотечной функции
.Xr printf 3 .
.Sh ПРЕДОСТЕРЕЖЕНИЯ
Шестнадцатеричные символьные константы ANSI намеренно не предоставлены.
.Pp
Тире может быть неверно истолковано
.Nm
как аргумент программы.
Необходимо использовать
.Nm --
перед
.Ar форматом .
.Pp
Если локаль содержит многобайтовые символы
(например, UTF-8),
формат
.Cm c
и форматы
.Cm b
и
.Cm s
с точностью
могут работать не так, как ожидается.
.Sh ИЗВЕСТНЫЕ ОШИБКИ
Поскольку числа с плавающей точкой переводятся из ASCII
в числа с плавающей точкой и затем обратно, точность чисел с плавающей точкой может быть потеряна.
(По умолчанию число переводится в значение двойной точности IEEE-754
перед выводом.
Модификатор
.Cm L
может обеспечить дополнительную точность в зависимости от аппаратной платформы.)
.Pp
Escape-последовательность \e000 является признаком конца строки.
При её наличии в аргументе для формата
.Cm b
аргумент будет обрезан на символе \e000.
.Pp
Многобайтовые символы не распознаются в строках формата (это представляет
проблему только если
.Ql %
может появиться внутри многобайтового символа).
