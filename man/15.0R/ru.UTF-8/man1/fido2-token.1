.\" Copyright (c) 2018-2022 Yubico AB. All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions are
.\" met:
.\"
.\"    1. Redistributions of source code must retain the above copyright
.\"       notice, this list of conditions and the following disclaimer.
.\"    2. Redistributions in binary form must reproduce the above copyright
.\"       notice, this list of conditions and the following disclaimer in
.\"       the documentation and/or other materials provided with the
.\"       distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
.\" "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
.\" LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
.\" A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
.\" HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
.\" SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
.\" LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
.\" OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" SPDX-License-Identifier: BSD-2-Clause
.\"
.\" FRDP path ./contrib/libfido2/man/fido2-token.1
.\" FRDP githash 2ccfa855b2fc331819953e3de1b1c15ce5b95a7e
.\" FRDP hash256 58926ec8838295598c66049d77515e1455574919443a58499940d7f2c50ec63d
.Dd $Mdocdate: 11 апреля 2022 $
.Dt FIDO2-TOKEN 1
.Os
.Sh ИМЯ
.Nm fido2-token
.Nd найти и управлять аутентификатором FIDO2
.Sh СИНТАКСИС
.Nm
.Fl C
.Op Fl d
.Ar устройство
.Nm
.Fl D
.Op Fl d
.Fl i
.Ar cred_id
.Ar устройство
.Nm
.Fl D
.Fl b
.Op Fl d
.Fl k Ar key_path
.Ar устройство
.Nm
.Fl D
.Fl b
.Op Fl d
.Fl n Ar rp_id
.Op Fl i Ar cred_id
.Ar устройство
.Nm
.Fl D
.Fl e
.Op Fl d
.Fl i
.Ar template_id
.Ar устройство
.Nm
.Fl D
.Fl u
.Op Fl d
.Ar устройство
.Nm
.Fl G
.Fl b
.Op Fl d
.Fl k Ar key_path
.Ar blob_path
.Ar устройство
.Nm
.Fl G
.Fl b
.Op Fl d
.Fl n Ar rp_id
.Op Fl i Ar cred_id
.Ar blob_path
.Ar устройство
.Nm
.Fl I
.Op Fl cd
.Op Fl k Ar rp_id Fl i Ar cred_id
.Ar устройство
.Nm
.Fl L
.Op Fl bder
.Op Fl k Ar rp_id
.Op устройство
.Nm
.Fl R
.Op Fl d
.Ar устройство
.Nm
.Fl S
.Op Fl adefu
.Ar устройство
.Nm
.Fl S
.Op Fl d
.Fl i Ar template_id
.Fl n Ar template_name
.Ar устройство
.Nm
.Fl S
.Op Fl d
.Fl l Ar pin_length
.Ar устройство
.Nm
.Fl S
.Fl b
.Op Fl d
.Fl k Ar key_path
.Ar blob_path
.Ar устройство
.Nm
.Fl S
.Fl b
.Op Fl d
.Fl n Ar rp_id
.Op Fl i Ar cred_id
.Ar blob_path
.Ar устройство
.Nm
.Fl S
.Fl c
.Op Fl d
.Fl i Ar cred_id
.Fl k Ar user_id
.Fl n Ar name
.Fl p Ar display_name
.Ar устройство
.Nm
.Fl S
.Fl m
.Ar rp_id
.Ar устройство
.Nm
.Fl V
.Sh ОПИСАНИЕ
.Nm
управляет аутентификатором FIDO2.
.Pp
Параметры следующие:
.Bl -tag -width Ds
.It Fl C Ar устройство
Изменяет PIN-код для
.Ar устройства .
Пользователю будет предложено ввести текущий и новый PIN-коды.
.It Fl D Fl i Ar id Ar устройство
Удаляет резидентный ключ учётных данных, указанный
.Ar id ,
с
.Ar устройства ,
где
.Ar id
— это идентификатор ключа в кодировке base64.
Пользователю будет предложено ввести PIN-код.
.It Fl D Fl b Fl k Ar key_path Ar устройство
Удаляет
.Dq largeBlob ,
зашифрованный с помощью
.Ar key_path ,
с
.Ar устройства ,
где
.Ar key_path
содержит 32-байтный ключ шифрования AES-256 GCM для большого двоичного объекта в кодировке base64.
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl D Fl b Fl n Ar rp_id Oo Fl i Ar cred_id Oc Ar устройство
Удаляет
.Dq largeBlob ,
соответствующий
.Ar rp_id ,
с
.Ar устройства .
Если для
.Ar rp_id
на
.Ar устройстве
зарегистрировано несколько учётных данных, необходимо указать идентификатор учётных данных с помощью
.Fl i Ar cred_id ,
где
.Ar cred_id
— это большой двоичный объект в кодировке base64.
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl D Fl e Fl i Ar id Ar устройство
Удаляет биометрическую регистрацию, указанную
.Ar id ,
с
.Ar устройства ,
где
.Ar id
— это идентификатор шаблона регистрации в кодировке base64.
Пользователю будет предложено ввести PIN-код.
.It Fl D Fl u Ar устройство
Отключает функцию CTAP 2.1
.Dq "user verification always"
на
.Ar устройстве .
.It Fl G Fl b Fl k Ar key_path Ar blob_path Ar устройство
Получает CTAP 2.1
.Dq largeBlob ,
зашифрованный с помощью
.Ar key_path ,
с
.Ar устройства ,
где
.Ar key_path
содержит 32-байтный ключ шифрования AES-256 GCM для большого двоичного объекта в кодировке base64.
Большой двоичный объект записывается в
.Ar blob_path .
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl G Fl b Fl n Ar rp_id Oo Fl i Ar cred_id Oc Ar blob_path Ar устройство
Получает CTAP 2.1
.Dq largeBlob ,
связанный с
.Ar rp_id ,
с
.Ar устройства .
Если для
.Ar rp_id
на
.Ar устройстве
зарегистрировано несколько учётных данных, необходимо указать идентификатор учётных данных с помощью
.Fl i Ar cred_id ,
где
.Ar cred_id
— это большой двоичный объект в кодировке base64.
Большой двоичный объект записывается в
.Ar blob_path .
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl I Ar устройство
Получает информацию о
.Ar устройстве .
.It Fl I Fl c Ar устройство
Получает метаданные резидентных ключей учётных данных с
.Ar устройства .
Пользователю будет предложено ввести PIN-код.
.It Fl I Fl k Ar rp_id Fl i Ar cred_id Ar устройство
Выводит идентификатор учётных данных (в кодировке base64) и открытый ключ
(в кодировке PEM) резидентного ключа учётных данных, указанного
.Ar rp_id
и
.Ar cred_id ,
где
.Ar rp_id
— это идентификатор стороны, полагающейся на аутентификацию, в UTF-8, а
.Ar cred_id
— это идентификатор учётных данных в кодировке base64.
Пользователю будет предложено ввести PIN-код.
.It Fl L
Выводит список аутентификаторов, найденных операционной системой.
.It Fl L Fl b Ar устройство
Выводит список CTAP 2.1
.Dq largeBlobs
на
.Ar устройстве .
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl L Fl e Ar устройство
Выводит список биометрических регистраций на
.Ar устройстве .
Пользователю будет предложено ввести PIN-код.
.It Fl L Fl r Ar устройство
Выводит список сторон, полагающихся на аутентификацию, с резидентными ключами учётных данных на
.Ar устройстве .
Пользователю будет предложено ввести PIN-код.
.It Fl L Fl k Ar rp_id Ar устройство
Выводит список резидентных ключей учётных данных, соответствующих
стороне, полагающейся на аутентификацию,
.Ar rp_id
на
.Ar устройстве .
Пользователю будет предложено ввести PIN-код.
.It Fl R
Выполняет сброс
.Ar устройства .
.Nm
НЕ будет запрашивать подтверждение.
.It Fl S
Устанавливает PIN-код для
.Ar устройства .
Пользователю будет предложено ввести PIN-код.
.It Fl S Fl a Ar устройство
Включает CTAP 2.1 Enterprise Attestation на
.Ar устройстве .
.It Fl S Fl b Fl k Ar key_path Ar blob_path Ar устройство
Устанавливает CTAP 2.1
.Dq largeBlob ,
зашифрованный с помощью
.Ar key_path ,
на
.Ar устройстве ,
где
.Ar key_path
содержит 32-байтный ключ шифрования AES-256 GCM для большого двоичного объекта в кодировке base64.
Большой двоичный объект считывается из
.Fa blob_path .
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl S Fl b Fl n Ar rp_id Oo Fl i Ar cred_id Oc Ar blob_path Ar устройство
Устанавливает CTAP 2.1
.Dq largeBlob ,
связанный с
.Ar rp_id ,
на
.Ar устройстве .
Большой двоичный объект считывается из
.Fa blob_path .
Если для
.Ar rp_id
на
.Ar устройстве
зарегистрировано несколько учётных данных, необходимо указать идентификатор учётных данных с помощью
.Fl i Ar cred_id ,
где
.Ar cred_id
— это большой двоичный объект в кодировке base64.
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl S Fl c Fl i Ar cred_id Fl k Ar user_id Fl n Ar name Fl p Ar display_name Ar устройство
Устанавливает атрибуты
.Ar name
и
.Ar display_name
резидентного ключа учётных данных, идентифицируемого
.Ar cred_id
и
.Ar user_id ,
где
.Ar name
и
.Ar display_name
— строки в UTF-8, а
.Ar cred_id
и
.Ar user_id
— большие двоичные объекты в кодировке base64.
Требуется PIN-код или эквивалентный жест верификации пользователя.
.It Fl S Fl e Ar устройство
Выполняет новую биометрическую регистрацию на
.Ar устройстве .
Пользователю будет предложено ввести PIN-код.
.It Fl S Fl e Fl i Ar template_id Fl n Ar template_name Ar устройство
Устанавливает понятное имя биометрической регистрации, указанной
.Ar template_id ,
в
.Ar template_name
на
.Ar устройстве ,
где
.Ar template_id
представлен в кодировке base64, а
.Ar template_name
— строка в UTF-8.
Пользователю будет предложено ввести PIN-код.
.It Fl S Fl f Ar устройство
Принудительно изменяет PIN-код на
.Ar устройстве .
Пользователю будет предложено ввести PIN-код.
.It Fl S Fl l Ar pin_length Ar устройство
Устанавливает минимальную длину PIN-кода для
.Ar устройства
в
.Ar pin_length .
Пользователю будет предложено ввести PIN-код.
.It Fl S Fl m Ar rp_id Ar устройство
Устанавливает список идентификаторов сторон, полагающихся на аутентификацию, которым разрешено получать
минимальную длину PIN-кода для
.Ar устройства .
Можно указать несколько идентификаторов, разделённых запятыми.
Пользователю будет предложено ввести PIN-код.
.It Fl S Fl u Ar устройство
Включает функцию CTAP 2.1
.Dq "user verification always"
на
.Ar устройстве .
.It Fl V
Выводит информацию о версии.
.It Fl d
Приводит к тому, что
.Nm
выводит отладочную информацию на
.Em stderr .
.El
.Pp
Если доступен
.Em tty ,
.Nm
будет использовать его для запроса PIN-кодов.
В противном случае используется
.Em stdin .
.Pp
.Nm
завершается с кодом 0 при успехе и с кодом 1 при ошибке.
.Sh СМ. ТАКЖЕ
.Xr fido2-assert 1 ,
.Xr fido2-cred 1
.Sh ПРЕДОСТЕРЕЖЕНИЯ
Фактическая последовательность действий пользователя для выполнения сброса выходит за рамки
спецификации FIDO2 и поэтому может варьироваться в зависимости от
аутентификатора.
Аутентификаторы Yubico не позволяют выполнять сброс через 5 секунд после
включения питания и ожидают, что сброс будет подтверждён пользователем
касанием в течение 30 секунд.
.Pp
Путь к аутентификатору может содержать пробелы.
.Pp
Резидентные ключи учётных данных называются
.Dq "discoverable credentials"
в CTAP 2.1.
.Pp
Активирована или деактивирована ли функция CTAP 2.1
.Dq "user verification always"
после сброса аутентификатора —
зависит от производителя.
